import{Z as V}from"./zipcodes-YNp0Njm-.js";import{S as g}from"./sweetalert2.all-6m_Z_jZk.js";import{_ as S,g as E,c as i,a as s,F as C,f as p,n as u,b as l,w as y,r as w,o as d,e as v,h as k,i as B,p as R,d as q,t as D}from"./index-OEbCzfE_.js";const x="https://hexschool-freyja.onrender.com/api/v1/",N={data(){return{userStep:1,registerData:{email:"",password:"",confirmPassword:"",name:"",phone:"",birthday:"",isCheckRule:!1},organizedData:{},cityArray:[],addressSelected:{city:"",county:"",zipcode:"",detail:""},dayRange:0,birthday:{year:"",month:"",day:""}}},computed:{countyArray(){var o;return this.addressSelected.city?((o=this.organizedData[this.addressSelected.city])==null?void 0:o.countyList)||[]:[]}},watch:{"addressSelected.county":{handler(o){let e=this.countyArray.filter(h=>h.countyName==o.countyName);e.length>0&&(this.addressSelected.zipcode=e[0].ZipCode)},immediate:!0},"birthday.year":{handler:"handleBirthdayChange",immediate:!0},"birthday.month":{handler:"handleBirthdayChange",immediate:!0},"birthday.day":{handler:"handleBirthdayChange",immediate:!0}},methods:{changeStep(o){this.$refs.step1Form&&this.$refs.step1Form.validate().then(e=>{if(e.valid){let h={"Content-Type":"application/json",Accept:"application/json"},f={email:this.registerData.email};this.axios.post(`${x}verify/email`,f,{headers:h}).then(a=>{a.data.status?a.data.result.isEmailExists?g.fire({icon:"error",iconColor:"#dc3545",title:"此信箱已註冊過",showConfirmButton:!1,width:"400px",customClass:{title:"fs-4"}}):this.userStep=o:g.fire({icon:"error",iconColor:"#dc3545",title:a.data.message,showConfirmButton:!1,width:"400px",customClass:{title:"fs-4"}})}).catch(a=>{g.fire({icon:"error",iconColor:"#C22538",title:a.response.data.message,showConfirmButton:!1,width:"400px",customClass:{title:"fs-4"}})})}})},saveRegisterData(){if(this.$refs.step2Form){let o={"Content-Type":"application/json",Accept:"application/json"},e={name:this.registerData.name,email:this.registerData.email,password:this.registerData.password,phone:this.registerData.phone,birthday:this.registerData.birthday,address:{zipcode:Number(this.addressSelected.zipcode),detail:this.addressSelected.detail}};this.$refs.step2Form.validate().then(h=>{h.valid&&this.axios.post(`${x}user/signup`,e,{headers:o}).then(f=>{f.data.status?(g.fire({icon:"success",iconColor:"#299F65",title:"註冊成功!",showConfirmButton:!1,width:"400px",customClass:{title:"fs-4"}}),this.$router.push({name:"login"})):(g.fire({icon:"error",iconColor:"#dc3545",title:f.data.message,showConfirmButton:!1,width:"400px",customClass:{title:"fs-4"}}),this.userStep=1)}).catch(f=>{g.fire({icon:"error",iconColor:"#C22538",title:f.response.data.message,showConfirmButton:!1,width:"400px",customClass:{title:"fs-4"}})})})}},isLeapYear(o){return o%4===0&&o%100!==0||o%400===0},updateDayRange(o,e){const h=[1,3,5,7,8,10,12];this.dayRange=e===2?this.isLeapYear(o)?29:28:h.includes(e)?31:30},handleBirthdayChange(o){this.updateDayRange(this.birthday.year,o);const e=new Date(Number(this.birthday.year),Number(this.birthday.month)-1,Number(this.birthday.day));this.registerData.birthday=e.toISOString()},handleAddressSelect(){V.forEach(o=>{const{city:e,county:h,zipcode:f}=o;this.organizedData[e]||(this.organizedData[e]={CityName:e,countyList:[]}),this.organizedData[e].countyList.push({ZipCode:String(f),countyName:h})}),this.cityArray=Object.keys(this.organizedData)},updateValue(){this.registerData.isCheckRule=!this.registerData.isCheckRule.toString()}},mounted(){this.handleAddressSelect()}},n=o=>(R("data-v-5a85517d"),o=o(),q(),o),U=n(()=>s("span",{class:"text-primary"},"享樂酒店，誠摯歡迎",-1)),z=n(()=>s("h1",{class:"mb-7"},"立即註冊",-1)),j={class:"row g-1 stepper mb-7"},P={class:"col-auto d-flex"},L={class:"d-flex flex-column align-items-center"},I={class:"dot rounded-circle bg-primary d-flex align-items-center justify-content-center mb-1"},Y={key:1,class:"material-icons"},Z=n(()=>s("p",null,"輸入信箱及密碼",-1)),M=n(()=>s("div",{class:"col d-flex align-items-center"},[s("p",{class:"border-bottom border-gray w-100"})],-1)),O={class:"col-auto d-flex justify-content-end"},T=n(()=>s("p",null,"填寫基本資料",-1)),W={key:0,class:"row flex-column"},G={class:"col mb-3"},H={class:"form-label",for:"email"},J={class:"col mb-3"},K={class:"form-label",for:"password"},Q={class:"col mb-3"},X={class:"form-label",for:"confirmPassword"},$={class:"col mt-3"},ee={class:"col mb-3"},se=n(()=>s("span",{class:"pointer me-2"},"已經有會員了嗎?",-1)),te={key:0,class:"row flex-column"},ae={class:"col mb-3"},le={class:"form-label",for:"name"},oe={class:"col mb-3"},ie={class:"form-label",for:"phone"},de={class:"col mb-3"},re={class:"form-label",for:"birthday",label:"生日"},ue={class:"row g-2"},ne={class:"col-md-4"},ce=n(()=>s("option",{value:"",selected:""},"請選擇",-1)),me=["value"],he={class:"col-md-4"},pe=n(()=>s("option",{value:"",selected:""},"請選擇",-1)),fe=["value"],ye={class:"col-md-4"},_e=n(()=>s("option",{value:"",selected:""},"請選擇",-1)),be=["value"],Ce={class:"col-md-12 d-flex flex-row"},ve={class:"col mb-3"},ge={class:"form-label",for:"address",label:"地址"},Be={class:"row g-2"},De={class:"col-md-6"},we=n(()=>s("option",{value:"",selected:""},"請選擇",-1)),Fe=["value"],Ae={class:"col-md-6"},ke=n(()=>s("option",{value:"",selected:""},"請選擇",-1)),xe=["value"],Ve={class:"col-md-12"},Se={class:"col mb-3"},Ee={class:"form-check"},Re=n(()=>s("label",{class:"form-check-label",for:"pravicy"}," 我已閱讀並同意本網站個資使用規範",-1)),qe={class:"col mt-3"},Ne={class:"col mb-3"},Ue=n(()=>s("span",{class:"pointer me-2"},"已經有會員了嗎?",-1));function ze(o,e,h,f,a,_){const c=w("v-field"),m=w("ErrorMessage"),F=w("router-link"),A=w("v-form"),b=E("required");return d(),i(C,null,[U,z,s("div",j,[s("div",P,[s("div",L,[s("p",I,[a.userStep===1?(d(),i(C,{key:0},[p("1")],64)):(d(),i("span",Y," done "))]),Z])]),M,s("div",O,[s("div",{class:u(["d-flex flex-column align-items-center text-gray",{" text-white":a.userStep===2}])},[s("p",{class:u(["dot rounded-circle border border-gray bg-outline-gray d-flex align-items-center justify-content-center mb-1",{"bg-primary ":a.userStep===2}])}," 2 ",2),T],2)])]),l(A,{ref:"step1Form",onSubmit:_.changeStep},{default:y(({errors:r})=>[a.userStep===1?(d(),i("div",W,[s("div",G,[v((d(),i("label",H,[p("電子信箱")])),[[b,!0]]),l(c,{name:"email",id:"email",type:"email",class:u(["form-control",{"is-invalid":r.email}]),label:"帳號",placeholder:"hello@exsample.com",modelValue:a.registerData.email,"onUpdate:modelValue":e[0]||(e[0]=t=>a.registerData.email=t),rules:"required"},null,8,["class","modelValue"]),l(m,{name:"email",class:"invalid-feedback"})]),s("div",J,[v((d(),i("label",K,[p("密碼")])),[[b,!0]]),l(c,{name:"password",label:"密碼",type:"password",class:u(["form-control",{"is-invalid":r.password}]),id:"password",placeholder:"請輸入密碼",modelValue:a.registerData.password,"onUpdate:modelValue":e[1]||(e[1]=t=>a.registerData.password=t),rules:"required|min:8|password"},null,8,["class","modelValue"]),l(m,{name:"password",class:"invalid-feedback"})]),s("div",Q,[v((d(),i("label",X,[p("確認密碼")])),[[b,!0]]),l(c,{name:"confirmPassword",label:"確認密碼",type:"password",class:u(["form-control",{"is-invalid":r.confirmPassword}]),id:"confirmPassword",placeholder:"請再輸入一次密碼",modelValue:a.registerData.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>a.registerData.confirmPassword=t),rules:"required|confirmed:@password"},null,8,["class","modelValue"]),l(m,{name:"confirmPassword",class:"invalid-feedback"})]),s("div",$,[s("button",{type:"button",class:"btn py-3 btn-white w-100 site_button text-gray",onClick:e[3]||(e[3]=t=>_.changeStep(2))}," 下一步 ")]),s("div",ee,[se,l(F,{to:{name:"login"},role:"button",class:"btn text-decoration-underline text-primary pointer"},{default:y(()=>[p("立即登入")]),_:1})])])):k("",!0)]),_:1},8,["onSubmit"]),l(A,{ref:"step2Form",onSubmit:e[14]||(e[14]=r=>_.saveRegisterData())},{default:y(({errors:r})=>[a.userStep===2?(d(),i("div",te,[s("div",ae,[v((d(),i("label",le,[p("姓名")])),[[b,!0]]),l(c,{name:"name",label:"姓名",type:"text",class:u(["form-control",{"is-invalid":r.name}]),id:"name",placeholder:"輸入姓名",modelValue:a.registerData.name,"onUpdate:modelValue":e[4]||(e[4]=t=>a.registerData.name=t),rules:"required"},null,8,["class","modelValue"]),l(m,{name:"name",class:"invalid-feedback"})]),s("div",oe,[v((d(),i("label",ie,[p("手機號碼")])),[[b,!0]]),l(c,{name:"phone",label:"手機號碼",type:"text",class:u(["form-control",{"is-invalid":r.phone}]),id:"phone",placeholder:"請輸入手機號碼",modelValue:a.registerData.phone,"onUpdate:modelValue":e[5]||(e[5]=t=>a.registerData.phone=t),rules:"required|phone"},null,8,["class","modelValue"]),l(m,{name:"phone",class:"invalid-feedback"})]),s("div",de,[v((d(),i("label",re,[p("生日")])),[[b,!0]]),s("div",ue,[s("div",ne,[l(c,{name:"year",as:"select",label:"年",id:"birthday",class:u(["form-select",{"is-invalid":r.year}]),rules:"required",modelValue:a.birthday.year,"onUpdate:modelValue":e[6]||(e[6]=t=>a.birthday.year=t)},{default:y(()=>[ce,(d(),i(C,null,B(100,t=>s("option",{key:t,value:new Date().getFullYear()-(100-t)},D(new Date().getFullYear()-(100-t))+" 年 ",9,me)),64))]),_:2},1032,["class","modelValue"])]),s("div",he,[l(c,{name:"month",as:"select",label:"月",id:"birthday",class:u(["form-select",{"is-invalid":r.month}]),rules:"required",modelValue:a.birthday.month,"onUpdate:modelValue":e[7]||(e[7]=t=>a.birthday.month=t)},{default:y(()=>[pe,(d(),i(C,null,B(12,t=>s("option",{key:t,value:t},D(t)+" 月",9,fe)),64))]),_:2},1032,["class","modelValue"])]),s("div",ye,[l(c,{name:"day",as:"select",label:"日",id:"birthday",class:u(["form-select",{"is-invalid":r.day}]),rules:"required",modelValue:a.birthday.day,"onUpdate:modelValue":e[8]||(e[8]=t=>a.birthday.day=t)},{default:y(()=>[_e,(d(!0),i(C,null,B(a.dayRange,t=>(d(),i("option",{key:t,value:t},D(t)+" 日",9,be))),128))]),_:2},1032,["class","modelValue"])]),s("div",Ce,[l(m,{name:"year",class:"invalid-feedback"}),l(m,{name:"month",class:"invalid-feedback"}),l(m,{name:"day",class:"invalid-feedback"})])])]),s("div",ve,[v((d(),i("label",ge,[p("地址")])),[[b,!0]]),s("div",Be,[s("div",De,[l(c,{name:"city",as:"select",label:"縣市",id:"address",class:u(["form-select",{"is-invalid":r.city}]),modelValue:a.addressSelected.city,"onUpdate:modelValue":e[9]||(e[9]=t=>a.addressSelected.city=t),rules:"required"},{default:y(()=>[we,(d(!0),i(C,null,B(a.cityArray,t=>(d(),i("option",{key:t,value:t},D(t),9,Fe))),128))]),_:2},1032,["class","modelValue"])]),s("div",Ae,[l(c,{name:"county",as:"select",label:"鄉鎮區",id:"address",class:u(["form-select",{"is-invalid":r.county}]),modelValue:a.addressSelected.county,"onUpdate:modelValue":e[10]||(e[10]=t=>a.addressSelected.county=t),rules:"required"},{default:y(()=>[ke,(d(!0),i(C,null,B(_.countyArray,t=>(d(),i("option",{key:t.countyName,value:t},D(t.countyName),9,xe))),128))]),_:2},1032,["class","modelValue"])]),s("div",Ve,[l(c,{name:"detail",type:"text",label:"詳細地址",class:u(["form-control",{"is-invalid":r.detail}]),id:"address",placeholder:"請輸入詳細地址",modelValue:a.addressSelected.detail,"onUpdate:modelValue":e[11]||(e[11]=t=>a.addressSelected.detail=t),rules:"required"},null,8,["class","modelValue"]),l(m,{name:"city",class:"invalid-feedback"}),l(m,{name:"county",class:"invalid-feedback"}),l(m,{name:"detail",class:"invalid-feedback"})])])]),s("div",Se,[s("div",Ee,[Re,l(c,{name:"isCheckRule",label:"個資使用規範",class:u([{"is-invalid":r.isCheckRule},"form-check-input"]),type:"checkbox",rules:"required",id:"pravicy",onClick:_.updateValue,modelValue:a.registerData.isCheckRule,"onUpdate:modelValue":e[12]||(e[12]=t=>a.registerData.isCheckRule=t),value:"true"},null,8,["class","onClick","modelValue"]),l(m,{name:"isCheckRule",class:"invalid-feedback"})])]),s("div",qe,[s("button",{type:"button",class:"btn py-3 btn-primary w-100 site_button text-white",onClick:e[13]||(e[13]=(...t)=>_.saveRegisterData&&_.saveRegisterData(...t))}," 完成註冊 ")]),s("div",Ne,[Ue,l(F,{to:{name:"login"},role:"button",class:"btn text-decoration-underline text-primary pointer"},{default:y(()=>[p("立即登入")]),_:1})])])):k("",!0)]),_:1},512)],64)}const Ie=S(N,[["render",ze],["__scopeId","data-v-5a85517d"]]);export{Ie as default};
